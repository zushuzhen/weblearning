**跳转**

```
navTo() {
  wx.navigateTo({url: '/pages/contract-add/contract-add'})
},
```

**缓存获取数据**

```
this.setData({"UserData": wx.getStorageSync('UserData')}) 
```

**数据添加缓存**

```
wx.setStorageSync('myData', myData);
```

**赋值**

```
this.setData({show: true});
```

**传值**

```
data-item="{{item}}"
```

**顶部标题栏（隐藏）**

```
"navigationStyle":"custom"
```

**打电话**

```js
catchtap='callPhone' data-item="{{item}}"

callPhone(e:any) {
  console.log("电话",e);
  let callPhone = e.currentTarget.dataset.item.phone;
  wx.makePhoneCall({
    phoneNumber: callPhone,
  })
},
```

**接口**

```
import getTeacherregister from './../../utils/getData'

let data= {}
let param = {
  API_URL: api.XXXX,
  method: "POST",
  };
  getData.result(param).then((resl) => {
  console.log("列表",resl);
  if(resl.statusCode == 200){
    this.setData({
      studentList: resl.data,
      last_page: resl.data.last_page
    })
  }
})
```

**静默获取用户位置**

```js
  doLocal: function (latitude, longitude) {
    var that = this;
    var mapUrl = 'https://apis.map.qq.com/ws/geocoder/v1/?location=' + latitude + ',' + longitude + '&key=' + '2ESBZ-AODC5-H5HI5-QJGC6-C44YJ-2OBAK';
    wx.request({
      url: mapUrl,
      data: {},
      header: {
        'Content-Type': 'application/json'
      },
      success: function (res) {
        console.log(res)
        if (res.statusCode == 200) {
          that.setData({
            'UserData.address': res.data.result.address,
            'UserData.location': JSON.stringify(res.data.result.location)
          })
          console.log(that.data.UserData.address);
          console.log(that.data.UserData.location);
        }
      },
    })
  },
```

**授权电话**

```js
getPhone(event: any) {
  console.log(event)
  let that = this
  wx.login({
    success: (res) => {
      console.log(res)
      let data = {
        code: res.code,
        encryptedData: event.detail.encryptedData,
        iv: event.detail.iv,
       }
       let param = {
         API_URL: api.后端接口,
         data: data,
         method: "POST",
       };
       getData.result(param).then((res: any) => {
         if (res.statusCode == 200) {
           that.setData({
             'UserData.phone': res.data.data.phone
           })
           wx.showToast({
             title: '授权成功',
             icon: 'success'
           })
         } else {
           wx.showToast({
           title: '授权失败',
           icon: 'error'
          })
        }
      })
    }
  })
},
```

## 隐私协议

```js
//隐私协议
navToSetting() {
    let that = this
    wx.getPrivacySetting({
      success: res => {
        console.log(res) // 返回结果为: res = { needAuthorization: true/false, privacyContractName: '《xxx隐私保护指引》' }
        if (res.needAuthorization) {
          that.setData({
            showPrivacy: true
          });
        } else {
          // 执行本页面的逻辑
        }
      },
      fail: () => {},
      complete: () => {}
    })
  },
  // 隐私协议取消
  getPrivacy() {
    this.setData({
      showPrivacy: false
    })
  },
  // 隐私协议同意
  handleAgreePrivacyAuthorization() {
    let that = this
    that.setData({
      showPrivacy: false
    })
    // 执行本页面的逻辑
  },
```



```js
<!-- 隐私内容 -->
<view wx:if="{{ showPrivacy }}" class="box-user ">
  <view class="box-title">
    <view class="text-center" style="font-weight: bold; font-size: 37rpx;">隐私内容</view>
    <view class="margin-top-sm" style="letter-spacing: 4rpx; word-spacing:2em; text-indent: 2em;">在您使用[老年大学停车预约服务]服务之前，请仔细阅读(后面简称停车预约服务)<text bindtap="handleOpenPrivacyContract" class="text-blue">《停车预约服务》。</text>如你同意《停车预约服务》，请点击“同意”开始使用[停车预约服务]。</view>
    <view class="flex margin-top">
      <button bind:tap="getPrivacy" class="btna">取消</button>
      <button class="btna btn-sure" id="agree-btn" open-type="agreePrivacyAuthorization" bindagreeprivacyauthorization="handleAgreePrivacyAuthorization">同意</button>
    </view>
  </view>
</view>


```



```css
.box-user {
 position: fixed
 top: 0;
 width: 100%;
 height: 100vh;
 background-color: rgba(0, 0, 0, 0.5);
 z-index: 999;
}
.box-title {
 width: 75%;
 height: 420rpx;
 margin: 0 auto;
 margin-top: 400rpx;
 padding: 20rpx;
 border-radius: 3%;
 background-color: #fff;
}
.btna {
 width: 200rpx !important;
}
.btn-sure {
 background-color: #1368e7;
 color: #fff;
}
.status-bar,
.menu-bar {
 position: fixed;
 top: 0;
 left: 0;
 width: 100%;
 z-index: 9;
}
.status-bar {
 background-color: #ffffff;
}
.menu-bar {
 background-color: #ffffff;
}
```

## 七牛云直传

```js
file: '',
fileList: [],  
qiniuData: {},
===========================================
afterRead(e) {
    console.log(e);
    let that = this
    const file = e.detail.file;
    this.setData({
      file,
    })
    let filePath = file.url
    let index = file.url.lastIndexOf('.')
    let end = file.url.slice(index)
    let data = {
      ext: end
    }
    console.log(data);
    wx.showLoading({
      title: '上传中...',
    })
    let param = {
      API_URL: api.bigFileUploadTokenUrl,
      data: data,
      method: "POST"
    }
    getData.result(param).then(res => {
      if (res.statusCode == 200) {
        console.log(res);
        this.setData({
          qiniuData: res.data,
        })
        wx.uploadFile({
          url: 'https://upload-z2.qiniup.com',
          filePath: filePath,
          name: 'file',
          header: {
            "Content-Type": "multipart/form-data"
          },
          formData: {
            token: that.data.qiniuData.token,
            key: that.data.qiniuData.key
          },
          success: function (resl) {
            wx.hideLoading()
            Toast.success('上传成功！');
            let file = res.data.url
            console.log(file);
            that.setData({
             'fileList[0].url': file
            })
          }
        })
      }
    })
  },
```

